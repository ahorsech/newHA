lr_sensors:

    recorder:
      include:
        entities:
           - sensor.0x00158d00015aebb6_temperature
           - sensor.0x00158d00015aebb6_humidity
           
    homeassistant:
      customize:
        
        binary_sensor.lr_aeration:
          friendly_name: Гостиная, проветривание

        binary_sensor.lr_radiator:
          friendly_name: Гостиная, режим отопления      
          
          
        binary_sensor.0x00158d00013ed373_contact:
          friendly_name: Гостиная, окно
          device_class: window
        sensor.0x00158d00013ed373_battery:
          friendly_name: Гостиная, окно
        binary_sensor.0xec1bbdfffedf6a6a_contact:
          friendly_name: Гостиная, окно 2
          device_class: window
        sensor.0xec1bbdfffedf6a6a_battery:
          friendly_name: Гостиная, окно 2
        binary_sensor.0x00158d000445206b_contact:
          friendly_name: Гостиная, дверь на балкон
          device_class: door
        sensor.0x00158d000445206b_battery:
          friendly_name: Гостиная, дверь на балкон

        sensor.0x00158d00015aebb6_humidity:
          friendly_name: Гостиная, влажность
          icon: mdi:water-percent
        sensor.0x00158d00015aebb6_temperature:
          friendly_name: Гостиная, температура
          icon: mdi:temperature-celsius
        sensor.0x00158d00015aebb6_battery:
          friendly_name: Гостиная, климат  
          
        binary_sensor.lr_notification_time:
          friendly_name: Гостиная, время уведомлений о плохом воздухе
          device_class: running
          icon: mdi:clock-digital
          
        binary_sensor.0x54ef44100042e226_presence:
          friendly_name: Гостиная, присутствие

        binary_sensor.0x00158d0005414857_occupancy:
          friendly_name: Гостиная, движение
        sensor.0x00158d0005414857_battery:
          friendly_name: Гостиная, движение

    binary_sensor:
    
      - platform: tod
        name: lr_notification_time
        after: '10:00'
        before: '22:00'

      - platform: mqtt
        name: lr_radiator
        state_topic: "states/lr_radiator"
        payload_on: "ON"
        payload_off: "OFF" 
        
    switch:

      - platform: template
        switches:
          lr_radiator_mode:
            friendly_name: "Режим отопления Гостиная"
            value_template: "{{  is_state('binary_sensor.lr_radiator', 'on') }}"
            turn_on:
              service: mqtt.publish
              data_template:
                topic: "states/lr_radiator"
                payload_template: 'ON'
                retain: true 
            turn_off:
              service: mqtt.publish
              data_template:
                topic: "states/lr_radiator"
                payload_template: 'OFF'
                retain: true 
            icon_template: >-
              {% if is_state('switch.lr_radiator_mode', 'on') %}
                mdi:radiator
              {% else %}
                mdi:radiator-off
              {% endif %}
          
    template:
     
      - binary_sensor:

          - name: lr_aeration
            state: >
              {{ is_state('binary_sensor.0x00158d00013ed373_contact', 'on')  
                 or is_state('binary_sensor.0xec1bbdfffedf6a6a_contact', 'on')
                 or is_state('binary_sensor.0x00158d000445206b_contact', 'on')
              }}
            delay_on: 
                seconds: 30
            device_class: window
            icon: >
              {% if is_state("binary_sensor.lr_aeration", "on") %}
              mdi:window-open-variant
              {% else %}
              mdi:window-closed-variant
              {% endif %}

