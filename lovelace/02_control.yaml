############################ Телеметрия ############################
title: Телеметрия
icon: mdi:keyboard
cards:


############################ Колонка 1 ############################
    - type: vertical-stack
      cards:

        - type: custom:stack-in-card
          mode: vertical
          cards:
      
            - type: markdown
              style: |
                   ha-card {
                     color: #00BFFF;
                     font-weight: bold;
                     font-size: 16px;
                   }          
              content: >
                 **Автоматизации и скрипты**

################# Автоматизации #################

            - type: entities
              style: |
                   ha-card {
                     color: #00BFFF;
                     --paper-item-icon-color: #00BFFF;
                     --iron-icon-stroke-color: #FFFFE0;
                     font-weight: bold;
                     font-size: 14px;
                   }                 
              show_header_toggle: false
              entities:
              - entity: sensor.count_automation
                type: custom:multiple-entity-row
                name: Автоматизации
                state_header: Всего
                entities:
                  - entity: sensor.count_automation_on
                    name: Активно
                  - entity: sensor.count_automation_off
                    name: Отключено
                  - entity: sensor.count_automation_unavailable
                    name: Недоступно

            - type: custom:auto-entities
              show_empty: false
              card:
                type: entities
                show_header_toggle: false
                style: |
                  ha-card {
                    color: #00BFFF;
                    --paper-item-icon-color: #E6E6FA;
                    font-weight: bold;
                    font-size: 14px;
                  }
              filter:
                include:
                 - domain: automation
                   state: 'unavailable'
                   options:
                      secondary_info: last-changed
                      
################# Скрипты #################

            - type: entities
              style: |
                   ha-card {
                     color: #00BFFF;
                     --paper-item-icon-color: #00BFFF;
                     --iron-icon-stroke-color: #FFFFE0;
                     font-weight: bold;
                     font-size: 14px;
                   }                 
              show_header_toggle: false
              entities:
              - entity: sensor.count_script
                type: custom:multiple-entity-row
                name: Скрипты
                state_header: Всего
                entities:
                  - entity: sensor.count_script_on
                    name: Активно
                  - entity: sensor.count_script_off
                    name: Отключено
                  - entity: sensor.count_script_unavailable
                    name: Недоступно

            - type: custom:auto-entities
              show_empty: false
              card:
                type: entities
                show_header_toggle: false
                style: |
                  ha-card {
                    color: #00BFFF;
                    --paper-item-icon-color: #E6E6FA;
                    font-weight: bold;
                    font-size: 14px;
                  }
              filter:
                include:
                 - domain: script
                   state: 'unavailable'
                   options:
                      secondary_info: last-changed 
                      
############################ Колонка 2 ############################
    - type: vertical-stack
      cards:


        - type: custom:stack-in-card
          mode: vertical
          cards:

################# Светильники #################
      
            - type: markdown
              style: |
                  ha-card {
                    color: #FA8072;
                    font-weight: bold;
                    font-size: 16px;
                  } 
              content: >
                  **Cветильники**
                  
            - type: entities
              style: |
                    ha-card {
                      color: #FA8072;
                      --paper-item-icon-color: #E6E6FA;
                      --iron-icon-stroke-color: #E6E6FA;
                      font-weight: bold;
                      font-size: 14px;
                    }               
              show_header_toggle: false
              entities:
              - entity: sensor.count_light
                type: custom:multiple-entity-row
                name: Светильники
                state_header: Всего
                entities:
                  - entity: sensor.count_light_on
                    name: Активно
                  - entity: sensor.count_light_off
                    name: Отключено
                  - entity: sensor.count_light_unavailable
                    name: Недоступно
                    
            - type: custom:auto-entities
              show_empty: false
              card:
                type: entities
                show_header_toggle: false
                style: |
                    ha-card {
                      color: #FA8072;
                      --paper-item-icon-color: #E6E6FA;
                      --iron-icon-stroke-color: #E6E6FA;
                      font-weight: bold;
                      font-size: 14px;
                    }  
              filter:
                include:
                 - domain: light
                   state: 'unavailable'
                   options:
                      secondary_info: last-changed
                      
################# Реле #################
      
            - type: markdown
              style: |
                  ha-card {
                    color: #FA8072;
                    font-weight: bold;
                    font-size: 16px;
                  } 
              content: >
                  **Реле**
                  
            - type: entities
              style: |
                    ha-card {
                      color: #FA8072;
                      --paper-item-icon-color: #E6E6FA;
                      --iron-icon-stroke-color: #E6E6FA;
                      font-weight: bold;
                      font-size: 14px;
                    }               
              show_header_toggle: false
              entities:
              - entity: sensor.count_switch
                type: custom:multiple-entity-row
                name: Реле
                state_header: Всего
                entities:
                  - entity: sensor.count_switch_on
                    name: Активно
                  - entity: sensor.count_switch_off
                    name: Отключено
                  - entity: sensor.count_switch_unavailable
                    name: Недоступно
                    
            - type: custom:auto-entities
              show_empty: false
              card:
                type: entities
                show_header_toggle: false
                style: |
                    ha-card {
                      color: #FA8072;
                      --paper-item-icon-color: #E6E6FA;
                      --iron-icon-stroke-color: #E6E6FA;
                      font-weight: bold;
                      font-size: 14px;
                    }  
              filter:
                include:
                 - domain: switch
                   state: 'unavailable'
                   options:
                      secondary_info: last-changed 
                      
################# Термоголовки #################
      
            - type: markdown
              style: |
                  ha-card {
                    color: #FA8072;
                    font-weight: bold;
                    font-size: 16px;
                  } 
              content: >
                  **Термоголовки**
                  
            - type: entities
              style: |
                    ha-card {
                      color: #FA8072;
                      --paper-item-icon-color: #E6E6FA;
                      --iron-icon-stroke-color: #E6E6FA;
                      font-weight: bold;
                      font-size: 14px;
                    }               
              show_header_toggle: false
              entities:
              - entity: sensor.count_climate
                type: custom:multiple-entity-row
                name: Термоголовки
                state_header: Всего
                entities:
                  - entity: sensor.count_climate_heat
                    name: Активно
                  - entity: sensor.count_climate_off
                    name: Отключено
                  - entity: sensor.count_climate_unavailable
                    name: Недоступно
                    
            - type: custom:auto-entities
              show_empty: false
              card:
                type: entities
                show_header_toggle: false
                style: |
                    ha-card {
                      color: #FA8072;
                      --paper-item-icon-color: #E6E6FA;
                      --iron-icon-stroke-color: #E6E6FA;
                      font-weight: bold;
                      font-size: 14px;
                    }  
              filter:
                include:
                 - domain: climate
                   state: 'unavailable'
                   options:
                      secondary_info: last-changed 
                      
################# Сенсоры #################

            - type: markdown
              style: |
                  ha-card {
                    color: #FA8072;
                    font-weight: bold;
                    font-size: 16px;
                  } 
              content: >
                  **Сенсоры**
                  
            - type: entities
              style: |
                    ha-card {
                      color: #FA8072;
                      --paper-item-icon-color: #E6E6FA;
                      --iron-icon-stroke-color: #E6E6FA;
                      font-weight: bold;
                      font-size: 14px;
                    }               
              show_header_toggle: false
              entities:
              - entity: sensor.count_sensor
                type: custom:multiple-entity-row
                name: Сенсоры
                state_header: Всего
                entities:
                  - entity: sensor.count_sensor_unavailable
                    name: Недоступно
                    
            - type: custom:auto-entities
              show_empty: false
              card:
                type: entities
                show_header_toggle: false
                style: |
                    ha-card {
                      color: #FA8072;
                      --paper-item-icon-color: #E6E6FA;
                      --iron-icon-stroke-color: #E6E6FA;
                      font-weight: bold;
                      font-size: 14px;
                    }  
              filter:
                include:
                 - domain: sensor
                   state: 'unavailable'
                   options:
                      secondary_info: last-changed 
                      
################# Бинарные сенсоры #################

            - type: markdown
              style: |
                  ha-card {
                    color: #FA8072;
                    font-weight: bold;
                    font-size: 16px;
                  } 
              content: >
                  **Бинарные сенсоры**
                  
            - type: entities
              style: |
                    ha-card {
                      color: #FA8072;
                      --paper-item-icon-color: #E6E6FA;
                      --iron-icon-stroke-color: #E6E6FA;
                      font-weight: bold;
                      font-size: 14px;
                    }               
              show_header_toggle: false
              entities:
              - entity: sensor.count_binary_sensor
                type: custom:multiple-entity-row
                name: Бинарные сенсоры
                state_header: Всего
                entities:
                  - entity: sensor.count_binary_sensor_unavailable
                    name: Недоступно
                    
            - type: custom:auto-entities
              show_empty: false
              card:
                type: entities
                show_header_toggle: false
                style: |
                    ha-card {
                      color: #FA8072;
                      --paper-item-icon-color: #E6E6FA;
                      --iron-icon-stroke-color: #E6E6FA;
                      font-weight: bold;
                      font-size: 14px;
                    }  
              filter:
                include:
                 - domain: binary_sensor
                   state: 'unavailable'
                   options:
                      secondary_info: last-changed 

################# Уровень заряда #################
                      
        - type: custom:stack-in-card
          mode: vertical
          cards:
           
            - type: markdown
              style: |
                  ha-card {
                    color: #FA8072;
                    font-weight: bold;
                    font-size: 16px;
                  } 
              content: >
                  **Сенсоры < 30% заряда**
            - type: custom:auto-entities
              show_empty: false
              card:
                type: custom:battery-state-card
                show_header_toggle: false
                style: |
                    ha-card {
                      color: #FA8072;
                      font-weight: bold;
                      font-size: 14px;
                    } 
              filter:
                include:
                 - entity_id: sensor.*battery*
                exclude:
                 - state: '> 30.0'
                 - state: 'unknown'
                 - state: 'unavailable'
        
############################ Колонка 3 ############################
    - type: vertical-stack
      cards:
      
################# Потребление более 10 Ватт #################
 
        - type: custom:stack-in-card
          mode: vertical
          cards:

            - type: markdown
              style: |
                  ha-card {
                    color: #FFA500;
                    font-weight: bold;
                    font-size: 16px;
                  } 
              content: >
                  **Активные розетки > 10 Ватт**

            - type: custom:auto-entities
              card:
                type: entities
                show_header_toggle: false
              filter:
                include:
                - domain: switch
                  state: 'on'
                  attributes:
                    power: '! none'
                  options:
                     type: custom:multiple-entity-row
                     toggle: true
                    #  show_state: false
                     secondary_info: last-changed
                     entities:
                      - attribute: power
                        name: Потребление
                        unit: 'Ватт'
                exclude:
                - domain: switch
                  state: 'on'
                  attributes:
                    power: '< 10'
                - entity_id: switch.*power_outage*
                
        - type: custom:stack-in-card
          mode: vertical
          cards:

            - type: markdown
              style: |
                  ha-card {
                    color: #FFA500;
                    font-weight: bold;
                    font-size: 16px;
                  } 
              content: >
                  **Активные светильники**

            - type: custom:auto-entities
              card:
                type: entities
                show_header_toggle: false
              filter:
                include:
                - domain: light
                  state: 'on'
                  options:
                     type: custom:multiple-entity-row
                     toggle: true
                    #  show_state: false
                     secondary_info: last-changed
                     entities:
                      - attribute: brightness
                        name: Яркость
                      - attribute: color_temp
                        name: Температура

                      
        - type: custom:stack-in-card
          mode: vertical
          cards:

            - type: markdown
              style: |
                  ha-card {
                    color: #FFA500;
                    font-weight: bold;
                    font-size: 16px;
                  } 
              content: >
                  **Активные таймеры**

            - type: custom:auto-entities
              show_empty: false
              card:
                type: entities
                show_header_toggle: false
              filter:
                include:
                 - domain: timer
                   state: 'active'
                   options:
                      secondary_info: last-changed